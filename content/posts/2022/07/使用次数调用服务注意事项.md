---
title: "使用次数调用服务注意事项"
date: 2022-07-20T08:39:49+08:00
draft: false
---

## 最近连续两次出现多次调用

网站会刷新cookies，在每天早上5点。然后就出现了200多次调用，目前多花费了1块多钱，超出预计了。

原因说明，两种超时不再调用的手段失败。1. pm2的最大重试要用yaml，一开始没有用，现在写好了也不知道有没有用。2.使用redis的判断最大值，没有考虑到原子性，没有写到程序调用服务中，下次直接依赖redis。



然后应该是最大窗口的问题，不知道为什么用到了相对窗口位置，导致没有调用成功，添加了maxinaze windows。

## 需要注意使用服务的情况。

+ 使用云服务，如果是用网页页面，添加余额预警，添加每月消费预警，如果是使用sdk，做啥每个云服务先添加告警措施。
+ 这次使用的小站的验证码服务，需要添加每小时的使用次数（轮询作为服务cron，然后判断每小时消费，高于每小时消费就停止服务。）！！！ 新的云服务要优先添加！！！添加完之后才能用。
+ 没有就做warpper完成任务。



## pm2 

用yaml，额外调试logs

```Bash
 pm2 logs --lines 1000 --err
```



## Aliyun

添加cdn的告警机制！！！

