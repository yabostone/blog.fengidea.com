---
title: "Openwrt家用配置流程"
date: 2022-05-23T15:16:01+08:00
draft: false

---

op家用修改拓扑。主路由可以是单一硬路由，配上op。

## 主路由

考虑用低功耗？或者普通功耗的，加上4口网卡（100元）做虚拟机设置。（Ryzen可以了）

然后配上v6网段分割网段。

下面再挂一个op，专门作为服务器网段。连接wg。（配上v6）



### v6设定

最好的想法是，每个都有v6；出站不管v4和v6都能正常访问，添加表 出站v6，如果是国内直接出站，如果是国外（这里没法出站？可以出站）可以出站。回源，全部可回，不做防火墙。



dns 国外的dns 全部走ipv4。


我的方法其实几年前我就在用了，只是没发出来，看着论坛还是有很多小白面对着IPV6的困扰，我还是发出来好了。
解决办法思路如下：
1，smartdns的第一组正常开启IPV6的解析，正常不用FQ的网站就使用第一组能解析IPV6的DNS服务器就好了。
换言之：第一组开启IPV6解析，用于国内
2，再使用smartdns的第二组DNS解析，第二组关掉IPV6的解析，让被Q的网站的停掉IPV6解析。
换言之：第二组关掉IPV6解析，用于国外

这样的好处是即能开启IPV6，也不影响出国海淘。

![image-20220523153408778](https://res.cloudinary.com/dbzr1zvpf/image/upload/v1653291252/2022/05/51e8f1c57b5c969d5b2f0becf34ee8fe.webp)

DNS 国外的全部解析v4，国内可以解析v6

这样国外的vps，如果是dns的话就默认v4，dns由代理控制，解析时候返回国外的v4的ip值。如果自己直接访问ipv6，由于没有屏蔽，可以使用。只是在连接被墙站点时候，才使用v4.

![image-20220523160040277](https://res.cloudinary.com/dbzr1zvpf/image/upload/v1653292842/2022/05/d3c8e97e308eefb70284ec200071a37e.webp)

用Ping 判断网络是否发生变化，可以连接wireguard内部的ip，可以是外网的ddns判断。**在网络检测（网络检测）里面**
