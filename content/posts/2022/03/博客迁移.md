---
title: "博客迁移和博客环境配置"
date: 2022-03-23T21:11:13+08:00
tags:
  - cdn
categories:
  - 运维
draft: true
---



### 博客转向Amazon

之前的CDN是由render的cdn托管的，之前的cdn属于fastly，国内访问速度还是可以的，但是最近render将CDN转为free的cloudflare了，那么完全没有了优势，所以将网站转为手动上传到aws的s3，再进行cloudfront托管。

预计流程

1.下架相关域名，

2.更改上传方式，添加ignore将public屏蔽。

chocolate 安装

```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
```

3.添加rclone到系统Path位置，添加s3的秘钥

`chocolatey.exe install rclone`

4.考虑使用Picgo上传的图床方式，还是硬编码将链接格式不直接用static。而是将网址硬编码进去。

`chocolatey.exe install picgo`

5.public 写好脚本上传。

6.添加cloudfront，调整流量限流方式，防止被打DDOS。

7.计费项高于3刀时，手动将图片转为自己的VPS图床，使用lysky图床自建。(其他静态资源可以用cdn)



### 配置rclone

按照提示来，

测试：

`rclone ls blog.fengidea.com:blog.fengidea.com/`

`rclone sync -P .\public\ blog.fengidea.com:blog.fengidea.com/`

写脚本到git目录下。

#### 配置cloudfront 证书

需要配置cname确认本人拥有域名
